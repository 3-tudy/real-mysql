

# 함수 기반 인덱스

떄로는 칼럼의 값을 변형해서 인덱스를 구축할 필요가 있다. 이러한 경우 함수 기반 인덱스를 사용하면 된다.

함수 기반 인덱스는 두 가지 방법이 있다.
- 가상 칼럼을 이용한 인덱스
- 함수를 이용한 인덱스

함수 기반 인덱스는 값을 계산하는 과정만 다를 뿐, 실제 인덱스의 구조는 B-Tree와 동일하다.

---

## 가상 칼럼을 이용한 인덱스

인덱스를 추가하기 위해 가상 칼럼을 추가하는 방법이다. 가상 칼럼을 추가하는 방법은 테이블에 실제 칼럼을
추가하는 것과 같은 효과가 있다.

```sql
ALTER TABLE user
    ADD full_name VARCHAR(30) AS (CONCAT(first_name, ' ', last_name)) VIRTUAL
    ADD INDEX ix_fullname (full_name);
```

---

## 함수를 이용한 인덱스

함수를 직접 사용하는 인덱스는 테이블의 구조는 변경하지 않고, 계산된 결과값의 검색을 빠르게 만들어준다.
함수 기반 인덱스를 제대로 활용하려면 반드시 조건절에 `함수 기반 인덱스에 명시된 표현식`이 그대로 사용돼야 한다.

```sql
ALTER TABLE user
    ADD INDEX ix_fullname ((CONCAT(first_name, ' ', last_name)))
```

---

가상 칼럼과 함수를 이용한 인덱스 방식은 동일한 내부 구현으로 인해 성능 차이가 발생하지 않는다.